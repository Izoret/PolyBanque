<% page_header(@group.name, @group.description) %>

<div class="text-center mb-4">
  <div class="flex justify-center flex-wrap gap-1 mb-2">
    <% @group.users.each do |user| %>
      <span class="badge"><%= user.username %></span>
    <% end %>
  </div>

  <div class="mt-2 text-sm text-muted">
    Total groupe : <span class="font-mono text-main"><%= number_to_currency(@group.total_expenses, unit: "€") %></span>
  </div>
</div>

<%= render "balance" %>

<div class="flex gap-2 justify-center mt-4 mb-4">
  <%= link_to "Nouvelle Dépense", new_group_operation_path(@group), class: "btn btn-primary" %>
</div>

<div class="card mb-4">
  <%= form_with url: invite_group_path(@group), method: :post, local: true, class: "flex gap-2" do |form| %>
    <%= form.text_field :user, required: true, placeholder: "Inviter par email..." %>
    <%= form.submit "+", class: "btn btn-ghost btn-auto text-lg" %>
  <% end %>
</div>

<%= render "operations/all", operations: @operations.sort_by(&:date).reverse, group: @group %>

<div class="danger-zone">
  <% if @group.users.length > 1 %>
    <%= button_to "Quitter le groupe", quit_group_path(@group), method: :post,
                  class: "btn btn-danger-outline btn-auto",
                  data: { turbo_confirm: "Attention : Vos dettes ne seront pas effacées." } %>
  <% else %>
    <%= button_to "Supprimer le groupe", quit_group_path(@group), method: :post,
                  class: "btn btn-danger-outline btn-auto",
                  data: { turbo_confirm: "Supprimer définitivement ce groupe ?" } %>
  <% end %>
</div>